{"id":"mitamae-0eg","title":"Add SECURITY.md policy","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T09:55:10.606323-07:00","updated_at":"2025-12-18T10:34:15.171787-07:00","closed_at":"2025-12-18T10:34:15.171787-07:00","close_reason":"Closed"}
{"id":"mitamae-0hp","title":"Add Windows user/group resource support","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-18T10:49:42.172933-07:00","updated_at":"2025-12-18T10:49:42.172933-07:00","dependencies":[{"issue_id":"mitamae-0hp","depends_on_id":"mitamae-6cl","type":"blocks","created_at":"2025-12-18T12:46:01.907328-07:00","created_by":"daemon","metadata":"{}"}]}
{"id":"mitamae-1ii","title":"Fix mruby-tempfile close args and narrow CI tests","description":"Summary: mruby-tempfile CI fails because Tempfile#close does not accept an argument in practice, and full mruby test suite is failing due to unrelated mruby-onig-regexp errors. Make Tempfile#close accept optional args robustly and limit CI to gem tests.\\n\\nFiles to modify:\\n- mruby-tempfile/mrblib/tempfile.rb\\n- mruby-tempfile/.github/workflows/windows.yml\\n\\nImplementation steps:\\n1. Change Tempfile#close to accept *args, derive real flag, and call super() then delete if real.\\n2. Update Ubuntu and Windows CI steps to run 'ruby run_test.rb test:mrbgem:mruby-tempfile'.\\n3. Verify CI passes for Ubuntu + Windows matrix.\\n\\nExample:\\n- Before: t.close true =\u003e ArgumentError (expected 0)\\n- After: t.close true =\u003e deletes file","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-21T14:28:13.495232-07:00","updated_at":"2025-12-21T17:42:33.853017-07:00","closed_at":"2025-12-21T17:42:33.853017-07:00","close_reason":"Done"}
{"id":"mitamae-1me","title":"Investigate Windows-specific mruby gem compatibility","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-12-18T10:49:37.008184-07:00","updated_at":"2025-12-18T11:14:51.863638-07:00"}
{"id":"mitamae-1ve","title":"Investigate CI integration test NoMethodError in build workflow","description":"Summary: The build workflow 'test' job fails integration specs with repeated \"undefined method '[]' (NoMethodError)\" during apply_recipe for multiple recipes (color, define, directory, http_request, etc.). Identify the offending code path and fix the regression.\n\nFiles to modify:\n- spec/integration/** (add targeted repro if needed)\n- mrblib/mitamae/** (likely runtime code handling recipes)\n- Rakefile (if test harness needs adjustment)\n\nImplementation steps:\n1. Re-run the integration suite locally or in CI with backtrace enabled to capture the exact file/line for the NoMethodError.\n2. Identify which object is nil or not indexable when '[]' is called and why (e.g., node attributes, handler configs, plugin options).\n3. Fix the underlying regression; add a focused spec or update existing integration specs to cover the case.\n4. Verify build workflow test job passes.\n\nExample:\n- Failure excerpt: \"=== Apply /recipes/color.rb --no-color ===\" followed by \"undefined method '[]' (NoMethodError)\".\n- Expected: apply_recipe runs without errors for all recipes.\n","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-27T16:48:01.334552-07:00","created_by":"dominic","updated_at":"2025-12-27T19:02:58.912089-07:00","closed_at":"2025-12-27T19:02:58.912089-07:00","close_reason":"Restored node access in resource executors; NoMethodError no longer appears in integration tests","dependencies":[{"issue_id":"mitamae-1ve","depends_on_id":"mitamae-6cl","type":"discovered-from","created_at":"2025-12-27T16:48:01.335366-07:00","created_by":"dominic"}]}
{"id":"mitamae-25p","title":"Fix Windows package manager workflow script failures","description":"Summary: Windows Package Manager Test fails due to PowerShell here-string parsing in the winget step and unconditional Chocolatey uninstalls/fallback exit codes. Make scripts robust so tests only fail on real regressions.\n\nFiles to modify:\n- .github/workflows/windows-package-test.yml\n\nImplementation steps:\n1. Replace here-strings in the winget and fallback recipe creation steps with a PowerShell-safe string array/join so terminators are not indented.\n2. In the Chocolatey test, only uninstall packages if they are installed (or use a safe uninstall flag) to avoid failure when packages are missing.\n3. In the no-package-manager fallback test, ensure the step exits 0 even when mitamae returns non-zero (expected failure) while still logging the outcome.\n4. Remove the duplicate \"Cache Oniguruma\" step in test-chocolatey.\n\nExample:\n- Before: @\" ... \"@ | Out-File ... (fails with \"White space is not allowed before the string terminator\")\n- After: @(\"line1\", \"line2\") -join \"`n\" | Out-File ...\n","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-27T16:39:34.912621-07:00","created_by":"dominic","updated_at":"2025-12-27T16:46:06.633757-07:00","closed_at":"2025-12-27T16:46:06.633757-07:00","close_reason":"Completed","dependencies":[{"issue_id":"mitamae-25p","depends_on_id":"mitamae-6cl","type":"discovered-from","created_at":"2025-12-27T16:39:34.91359-07:00","created_by":"dominic"}]}
{"id":"mitamae-260","title":"Add RuboCop linting and code formatting","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T09:55:04.146493-07:00","updated_at":"2025-12-18T10:34:10.707773-07:00","closed_at":"2025-12-18T10:34:10.707773-07:00","close_reason":"Closed"}
{"id":"mitamae-2dq","title":"Add Windows file permission support (ACLs)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-18T10:49:44.65841-07:00","updated_at":"2025-12-18T10:49:44.65841-07:00","dependencies":[{"issue_id":"mitamae-2dq","depends_on_id":"mitamae-6cl","type":"blocks","created_at":"2025-12-18T12:46:01.982484-07:00","created_by":"daemon","metadata":"{}"}]}
{"id":"mitamae-2ed","title":"Fix Windows build failure in mruby-process (missing sys/wait.h)","description":"Summary: Windows CI fails compiling mruby-process because process.c includes POSIX headers (sys/wait.h, sys/select.h, unistd.h) and uses fork/waitpid/kill APIs. Implement Windows API-backed equivalents and update mitamae to use the forked mruby-process.\n\nFiles to modify:\n- mruby-process/src/process.c (Windows implementations using Win32 APIs; avoid POSIX headers)\n- mrbgem.rake (use github: 'dsisnero/mruby-process')\n\nImplementation steps:\n1. Add _WIN32 guards around POSIX-only includes and functions.\n2. Implement Windows helpers for getpid/getppid, kill, waitpid, sleep (use Win32 APIs).\n3. Define Windows-friendly WIFEXITED/WEXITSTATUS/etc macros for Process::Status.\n4. Push changes to dsisnero/mruby-process and update mitamae dependency.\n5. Rerun Windows CI.\n\nExample:\n- Before: #include \u003csys/wait.h\u003e fails on Windows\n- After: Windows builds use Win32 APIs and provide Process helpers.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-21T09:00:09.48966-07:00","updated_at":"2025-12-21T09:17:20.761743-07:00","closed_at":"2025-12-21T09:17:20.761743-07:00","close_reason":"Done"}
{"id":"mitamae-2ki","title":"Fix oniguruma.pc generation in Windows CI","description":"Summary: Windows CI installs oniguruma headers but mruby-onig-regexp still fails because the generated oniguruma.pc expands PowerShell variables in the here-string, producing Cflags: -I with no include path. Update the here-string to write explicit include/lib paths so pkg-config returns non-empty cflags.\\n\\nFiles to modify:\\n- .github/workflows/windows.yml (oniguruma.pc here-string)\\n- .github/workflows/test-windows.yml (oniguruma.pc here-string)\\n- .github/workflows/windows-package-test.yml (oniguruma.pc here-string)\\n\\nImplementation steps:\\n1. Replace exec_prefix/libdir/includedir lines to use prefixPc values directly.\\n2. Emit Cflags: -I\u003cprefixPc\u003e/include and Libs: -L\u003cprefixPc\u003e/lib -lonig.\\n3. Push and confirm pkg-config adds include path in build logs.\\n\\nExample:\\n- Before: Cflags: -I (expands to -I)\\n- After: Cflags: -I\u003cprefixPc\u003e/include","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-27T15:39:38.471097-07:00","created_by":"dominic","updated_at":"2025-12-27T15:41:09.322665-07:00","closed_at":"2025-12-27T15:41:09.322665-07:00","close_reason":"Updated oniguruma.pc generation to emit explicit include/lib paths","dependencies":[{"issue_id":"mitamae-2ki","depends_on_id":"mitamae-6cl","type":"discovered-from","created_at":"2025-12-27T15:39:38.472095-07:00","created_by":"dominic"}]}
{"id":"mitamae-3e3","title":"Fix mruby NoMethodError: defined? in recipe loader","description":"Summary: Integration tests fail because mruby does not support the `defined?` keyword, causing NoMethodError in recipe loading and Windows path setup. Replace `defined?` checks with const_defined? to keep compatibility.\n\nFiles to modify:\n- mrblib/mitamae/recipe_loader.rb (build_node WindowsPath guard)\n- mrblib/mitamae/windows_path.rb (File monkey patch guard)\n\nImplementation steps:\n1. Replace `defined?(MItamae::WindowsPath)` with `MItamae.const_defined?(:WindowsPath)` in both files.\n2. Run integration tests or CI to ensure recipes no longer error.\n\nExample:\n- Before: `defined?(MItamae::WindowsPath)` -\u003e NoMethodError in mruby\n- After: `MItamae.const_defined?(:WindowsPath)` works in mruby\n","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-27T16:15:17.570092-07:00","created_by":"dominic","updated_at":"2025-12-27T16:16:12.405834-07:00","closed_at":"2025-12-27T16:16:12.405834-07:00","close_reason":"Replaced defined? with const_defined? in mruby recipe loader and Windows path patch","dependencies":[{"issue_id":"mitamae-3e3","depends_on_id":"mitamae-nf3","type":"discovered-from","created_at":"2025-12-27T16:15:17.571372-07:00","created_by":"dominic"}]}
{"id":"mitamae-3o7","title":"Investigate Windows Test crash (-1073741819) in mitamae","description":"Summary: Windows Test run crashes mitamae-x86_64-windows.exe with exit code -1073741819 (0xC0000005 access violation) before windows_test.log is created. dumpbin shows mitamae depends on yaml.dll and yaml.dll depends on VCRUNTIME140.dll and CRT api-ms-win-crt-* DLLs; runtime still crashes with PATH including vcpkg and oniguruma bins.\n\nFiles to modify:\n- .github/workflows/test-windows.yml\n- build_config.rb\n- scripts/windows/** (if adding diagnostics)\n\nImplementation steps:\n1. Capture full crash context: run mitamae under a crash dumper (e.g., procdump) or enable WER dumps to identify the faulting module.\n2. Verify yaml.dll and its dependencies are present in PATH on the runner; use dumpbin to list dependents and confirm VCRUNTIME/CRT availability.\n3. If the crash is due to runtime mismatch, install the VC runtime or switch yaml to a static build; update build_config.rb accordingly.\n4. Re-run Windows Test and confirm windows_test.log is produced and tests proceed.\n\nExample:\n- CI output: \"mitamae exit code: -1073741819\" and \"windows_test.log not found\" in the Windows Test job.","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-27T18:58:44.294567-07:00","created_by":"dominic","updated_at":"2025-12-27T18:58:44.294567-07:00"}
{"id":"mitamae-4p0","title":"Test response file functionality in mrbc","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T14:22:52.733507-07:00","updated_at":"2025-12-21T07:49:15.878292-07:00","closed_at":"2025-12-21T07:49:15.878292-07:00","close_reason":"Done"}
{"id":"mitamae-56r","title":"Cache Windows CI dependencies (Zig/vcpkg)","description":"Summary: Windows workflows repeatedly download Zig and vcpkg packages, slowing CI. Add cache steps for Zig and vcpkg artifacts and skip Zig download when cached.\n\nFiles to modify:\n- .github/workflows/windows.yml\n- .github/workflows/test-windows.yml\n- .github/workflows/windows-package-test.yml\n\nImplementation steps:\n1. Add actions/cache steps for C:\\zig and C:\\vcpkg\\{installed,packages,downloads}.\n2. Update Setup Zig to reuse cached installation when present.\n3. Verify workflows run using cached paths on subsequent runs.\n\nExample:\n- Before: always downloads Zig zip\n- After: uses cached C:\\zig\\zig-windows-x86_64-0.10.1 when present","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T09:49:56.043591-07:00","updated_at":"2025-12-21T09:50:34.502319-07:00","closed_at":"2025-12-21T09:50:34.502319-07:00","close_reason":"Done"}
{"id":"mitamae-5qc","title":"Add RELEASE.md process documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T09:55:12.851614-07:00","updated_at":"2025-12-18T10:34:16.713973-07:00","closed_at":"2025-12-18T10:34:16.713973-07:00","close_reason":"Closed"}
{"id":"mitamae-6cl","title":"Fix Windows build failure (mruby-onig-regexp dependency)","description":"Windows build failures due to mruby-onig-regexp dependency on oniguruma library. Updated Windows CI workflows to install vcpkg pkgconf and set PKG_CONFIG_PATH. Also added patch to mruby command.rb to use response files for \u003e100 files (Windows command line limit). Need to verify both fixes work.","status":"in_progress","priority":1,"issue_type":"bug","created_at":"2025-12-18T12:45:30.540256-07:00","updated_at":"2025-12-18T14:57:02.329124-07:00"}
{"id":"mitamae-6su","title":"Fix Windows Test workflow template file creation","description":"Summary: Windows Test workflow fails writing templates/hello.erb because the templates directory is missing. Ensure the directory exists before writing the template file.\n\nFiles to modify:\n- .github/workflows/test-windows.yml\n\nImplementation steps:\n1. In the \"Create template file\" step, create the templates directory (e.g., New-Item -ItemType Directory -Force -Path templates).\n2. Write the template file after directory creation.\n3. Keep behavior identical otherwise.\n\nExample:\n- Before: Out-File -FilePath templates/hello.erb (fails if templates/ missing)\n- After: New-Item -ItemType Directory -Force -Path templates; Out-File -FilePath templates/hello.erb","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-27T16:39:15.790298-07:00","created_by":"dominic","updated_at":"2025-12-27T16:46:06.632407-07:00","closed_at":"2025-12-27T16:46:06.632407-07:00","close_reason":"Completed","dependencies":[{"issue_id":"mitamae-6su","depends_on_id":"mitamae-6cl","type":"discovered-from","created_at":"2025-12-27T16:39:15.791203-07:00","created_by":"dominic"}]}
{"id":"mitamae-7lm","title":"Implement alternative Windows command line length workaround if response files fail","description":"If response file approach fails due to linker/compiler issues with load_response_file function, implement alternative solutions for Windows command line length limit:\n\n1. **Batch compilation**: Split 390+ mruby-specinfra files into multiple batches (e.g., 100 files per batch) and compile separately\n2. **Windows API workaround**: Use GetCommandLine() and CommandLineToArgvW() or other Windows-specific APIs to handle long commands\n3. **Environment variable**: Use environment variables to pass file list (Windows supports longer env vars)\n4. **Temporary file list**: Write file list to temporary batch/shell script and execute it\n5. **Modified build system**: Change mruby build to generate intermediate object files for groups of files\n\nPriority approaches:\n- Batch compilation (simplest): Modify command.rb to split file list when \u003e100 files\n- Windows-specific handling: Use Windows APIs if batch compilation insufficient\n\nFiles to modify:\n- mruby/lib/mruby/build/command.rb (already patched for response files)\n- Rakefile (patching logic)\n- Potentially Windows-specific build configuration\n\nDependencies: Blocks on response file fix attempts (mitamae-nf3.2). If response files cannot be made to work, implement this as fallback.\n\nSuccess criteria:\n- Windows CI passes without \"Arg list too long\" errors\n- All files compiled successfully\n- Cross-compilation still works","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-20T10:16:13.515539-07:00","updated_at":"2025-12-20T10:16:28.846242-07:00","dependencies":[{"issue_id":"mitamae-7lm","depends_on_id":"mitamae-nf3.2","type":"blocks","created_at":"2025-12-20T10:16:36.443051-07:00","created_by":"daemon","metadata":"{}"}]}
{"id":"mitamae-7qq","title":"Add Windows CI to mruby-tempfile fork","description":"Summary: The mruby-tempfile fork lacks CI, making Windows fixes unverified. Add a Windows workflow that builds the gem with a MINGW64/MINGW32 matrix and caches MSYS2 and mruby checkout/build artifacts.\n\nFiles to modify:\n- mruby-tempfile/.github/workflows/windows.yml\n\nImplementation steps:\n1. Add a Windows workflow with matrix for MINGW64/MINGW32 using msys2/setup-msys2.\n2. Enable msys2 cache and add actions/cache for tmp/mruby and tmp/mruby/build.\n3. Run ruby run_test.rb in the MSYS2 shell to build and test.\n\nExample:\n- Before: no CI\n- After: Windows workflow runs on push/PR with caching enabled","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T10:03:51.017456-07:00","updated_at":"2025-12-21T10:05:24.74201-07:00","closed_at":"2025-12-21T10:05:24.74201-07:00","close_reason":"Done"}
{"id":"mitamae-7tt","title":"Fix version_spec nil MItamae::VERSION in CI","description":"Summary: build workflow integration test fails in spec/version_spec.rb because MItamae::VERSION is nil even though CHANGELOG.md lists 1.14.4. Ensure the version constant is loaded correctly during tests.\n\nFiles to modify:\n- spec/version_spec.rb\n- mrblib/mitamae/version.rb\n- spec/spec_helper.rb\n\nImplementation steps:\n1. Re-run spec/version_spec.rb in CI with extra logging to confirm MItamae::VERSION value after require_relative.\n2. Identify any earlier loads that redefine or unset MItamae::VERSION; fix the load order or constant definition.\n3. Update the spec to load the version file reliably and assert the latest version from CHANGELOG.md.\n4. Re-run build workflow to confirm only green tests remain.\n\nExample:\n- CI failure: expected \"1.14.4\", got nil at spec/version_spec.rb:11.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-27T18:59:02.801502-07:00","created_by":"dominic","updated_at":"2025-12-27T18:59:02.801502-07:00"}
{"id":"mitamae-7x5","title":"Switch mruby-tempfile Windows CI to Chocolatey MinGW","description":"Summary: mruby-tempfile Windows CI currently uses MSYS2; switch to Chocolatey MinGW to avoid requiring MSYS2 and align with Windows compiler usage. Also make run_test.rb shell-agnostic for PowerShell.\\n\\nFiles to modify:\\n- mruby-tempfile/.github/workflows/windows.yml\\n- mruby-tempfile/run_test.rb\\n\\nImplementation steps:\\n1. Replace MSYS2 setup with ruby/setup-ruby and Chocolatey MinGW install.\\n2. Add MinGW bin path to PATH based on arch and cache tmp/mruby and tmp/mruby/build.\\n3. Update run_test.rb to use Dir.chdir + system args (no shell cd) and handle git clone via system().\\n\\nExample:\\n- Before: MSYS2 shell + \"git clone ...; cd ...\"\\n- After: PowerShell-safe run_test.rb + choco mingw workflow","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T13:14:21.240179-07:00","updated_at":"2025-12-21T13:27:50.585449-07:00","closed_at":"2025-12-21T13:27:50.585449-07:00","close_reason":"Done"}
{"id":"mitamae-8ll","title":"Verify response file functionality in mrbc","description":"Once mrbc compiles successfully with load_response_file, need to verify response file functionality works correctly.\n\nFiles to test:\n- test_response.rb (test script)\n- mruby/lib/mruby/build/command.rb (response file creation logic)\n- mruby/mrbgems/mruby-bin-mrbc/tools/mrbc/mrbc.c (response file parsing)\n\nImplementation steps:\n1. Build host mrbc binary successfully\n2. Run test_response.rb to test response file creation logic\n3. Create manual test with actual Ruby files and response file\n4. Test edge cases:\n   - Empty response file\n   - Response file with Windows paths (backslashes)\n   - Response file with spaces in filenames\n   - Large number of files (\u003e100)\n5. Verify cleanup of response_argv memory works\n6. Test integration with mruby build system (command.rb) for specinfra files\n7. Ensure cross-compilation still works\n\nExample test:\n- Create test Ruby files\n- Generate response file\n- Run mrbc with @response_file\n- Verify compilation succeeds\n- Check memory cleanup","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-19T14:23:05.767499-07:00","updated_at":"2025-12-27T14:47:39.359001-07:00","closed_at":"2025-12-27T14:47:39.359001-07:00","close_reason":"Verified response file handling locally (200 inputs + empty rsp regression); Windows path/cross-compile checks tracked in Windows CI issues","dependencies":[{"issue_id":"mitamae-8ll","depends_on_id":"mitamae-x1f","type":"discovered-from","created_at":"2025-12-19T14:23:05.769016-07:00","created_by":"daemon","metadata":"{}"}]}
{"id":"mitamae-8vy","title":"Fix Specinfra missing in Windows i386 mitamae runtime","description":"Summary: Windows Build i386 test binary fails at runtime with \"uninitialized constant Specinfra (NameError)\" from mrblib/mitamae/backend.rb:8, even though mruby-specinfra is built in the log. Ensure Specinfra is loaded/initialized in the i386 Windows binary so mitamae local can run.\n\nFiles to modify:\n- build_config.rb\n- mrblib/mitamae/backend.rb\n- mrbgem.rake\n- mruby-specinfra/mrblib/specinfra.rb\n\nImplementation steps:\n1. Inspect the Windows Build log for the failing i386 job and confirm the NameError from mrblib/mitamae/backend.rb:8.\n2. Verify that mruby-specinfra is included in the i386 build (gem_init.c generation and MRBC logs) and that its mrblib is executed at runtime.\n3. If gem init is skipped in cross builds, adjust build_config.rb or gem initialization so Specinfra is defined before MItamae::Backend initializes.\n4. Add a focused CI check (or logging) to confirm Object.const_defined?(:Specinfra) is true in the Windows i386 binary.\n5. Re-run Windows Build to confirm Test binary no longer fails with NameError.\n\nExample:\n- CI error: \"mrblib/mitamae/backend.rb:8:in initialize: uninitialized constant Specinfra (NameError)\" during Windows Build (windows-i386) Test binary step.","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-27T18:57:58.290498-07:00","created_by":"dominic","updated_at":"2025-12-27T18:58:24.720117-07:00"}
{"id":"mitamae-a14","title":"Windows CI missing libyaml/oniguruma paths for zig builds","description":"Summary: Windows CI fails during build because the zig-based cross build cannot find libyaml headers and (for i386) the oniguruma library. Add explicit include/lib paths and -lyaml for vcpkg system libraries, and ensure oniguruma lib paths are on the linker search path.\n\nFiles to modify:\n- build_config.rb (add vcpkg libyaml include/lib paths + -lyaml when MRUBY_YAML_USE_SYSTEM_LIBRARY is set; add oniguruma lib path)\n- .github/workflows/windows.yml (set ONIGURUMA_PREFIX/VCPKG_ROOT env)\n- .github/workflows/test-windows.yml (set ONIGURUMA_PREFIX/VCPKG_ROOT env)\n- .github/workflows/windows-package-test.yml (set ONIGURUMA_PREFIX/VCPKG_ROOT env)\n\nImplementation steps:\n1. In build_config.rb windows cross-build blocks, add vcpkg include/lib paths and -lyaml when MRUBY_YAML_USE_SYSTEM_LIBRARY is enabled.\n2. Add ONIGURUMA_PREFIX include/lib paths to linker search path for Windows builds.\n3. Export ONIGURUMA_PREFIX and VCPKG_ROOT in Windows workflow Build mitamae steps.\n4. Re-run Windows Build/Test/Package workflows and confirm yaml.h and -lonig errors are gone.\n\nExample:\n- Before: yaml.c:4:10 fatal error: 'yaml.h' file not found; ld.exe: cannot find -lonig\n- After: Windows build proceeds past mruby-yaml and mruby-onig-regexp linking\n","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-27T16:16:03.282415-07:00","created_by":"dominic","updated_at":"2025-12-27T16:16:22.371112-07:00","closed_at":"2025-12-27T16:16:22.371112-07:00","close_reason":"Added vcpkg libyaml include/lib paths and oniguruma lib paths for Windows zig builds","dependencies":[{"issue_id":"mitamae-a14","depends_on_id":"mitamae-nf3","type":"discovered-from","created_at":"2025-12-27T16:16:03.283326-07:00","created_by":"dominic"}]}
{"id":"mitamae-amy","title":"Update CI to test both Chocolatey and winget","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T10:49:52.079164-07:00","updated_at":"2025-12-18T11:14:46.937225-07:00","closed_at":"2025-12-18T11:14:46.937227-07:00"}
{"id":"mitamae-auw","title":"Add Windows service resource support","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T10:49:39.66604-07:00","updated_at":"2025-12-18T11:14:41.265844-07:00","closed_at":"2025-12-18T11:14:41.265847-07:00"}
{"id":"mitamae-c3h","title":"integrate beads fully","description":"Fully integrated beads (bd) for issue tracking. Added comprehensive instructions to AGENTS.md covering workflow, dependencies, and best practices. Installed bd git hooks (post-merge, pre-push) for automatic sync. Configured .beads/ directory with issues.jsonl. Implemented agent workflow: bd ready to find work, bd update to claim, bd close when done. All future issue tracking should use bd commands instead of markdown TODOs or other tracking systems.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T09:50:13.812882-07:00","updated_at":"2025-12-18T12:31:16.53401-07:00","closed_at":"2025-12-18T12:31:16.53401-07:00","close_reason":"Beads (bd) fully integrated with AGENTS.md documentation, git hooks, and workflow established"}
{"id":"mitamae-cb3","title":"Add CI workflows to mruby-process fork","description":"Summary: The mruby-process fork lacks CI, so Windows/Linux build status is unknown. Add GitHub Actions workflows for Ubuntu and Windows (using Chocolatey MinGW, not MSYS2) with caching for mruby checkout/build.\n\nFiles to modify:\n- mruby-process/.github/workflows/ci.yml\n\nImplementation steps:\n1. Add Ubuntu job that caches tmp/mruby and tmp/mruby/build and runs ruby run_test.rb.\n2. Add Windows job with a mingw32/mingw64 matrix, installs MinGW via Chocolatey, and runs ruby run_test.rb.\n3. Cache tmp/mruby and tmp/mruby/build for Windows as well.\n\nExample:\n- Before: no CI\n- After: CI runs on push/PR for ubuntu + windows with caches","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T10:17:11.577009-07:00","updated_at":"2025-12-21T18:37:19.534046-07:00","closed_at":"2025-12-21T18:37:19.534046-07:00","close_reason":"Done"}
{"id":"mitamae-cib","title":"Enable GitHub Actions in fork repository settings","description":"GitHub Actions may be disabled in the fork repository settings. Need to enable Actions in GitHub UI: Settings → Actions → General → Allow all actions.\n\nAlso ensure gh CLI is configured for the fork:\n\n\nWorkflows have been updated for fork compatibility:\n- Repository owner changed from itamae-kitchen to dsisnero\n- Token references fixed (GITHUBTOKEN → GITHUB_TOKEN)\n- Release job permissions added (contents: write)\n\nCheck workflow runs with:\nin_progress\t\tAdd GitHub CLI workflow monitoring section to AGENTS.md\tWindows Build\tmaster\tpush\t20349206203\t1m43s\t2025-12-18T19:42:32Z\nin_progress\t\tAdd GitHub CLI workflow monitoring section to AGENTS.md\tbuild\tmaster\tpush\t20349206196\t1m43s\t2025-12-18T19:42:32Z\nin_progress\t\tAdd GitHub CLI workflow monitoring section to AGENTS.md\tWindows Test\tmaster\tpush\t20349206188\t1m43s\t2025-12-18T19:42:32Z\nin_progress\t\tUpdate GitHub workflows for fork compatibility\tbuild\tmaster\tpush\t20349141017\t4m13s\t2025-12-18T19:40:02Z\nin_progress\t\tUpdate GitHub workflows for fork compatibility\tWindows Build\tmaster\tpush\t20349140999\t4m13s\t2025-12-18T19:40:02Z\nin_progress\t\tUpdate GitHub workflows for fork compatibility\tWindows Test\tmaster\tpush\t20349140975\t4m13s\t2025-12-18T19:40:02Z\ncompleted\tfailure\tbd sync: 2025-12-18 12:31:23\tbuild\tmaster\tpush\t20348900801\t5m30s\t2025-12-18T19:31:28Z\ncompleted\tfailure\tbd sync: 2025-12-18 12:31:23\tWindows Test\tmaster\tpush\t20348900763\t5m4s\t2025-12-18T19:31:28Z\ncompleted\tfailure\tbd sync: 2025-12-18 12:31:23\tWindows Build\tmaster\tpush\t20348900757\t5m11s\t2025-12-18T19:31:28Z\ncompleted\tfailure\tbd sync: 2025-12-18 12:29:38\tWindows Build\tmaster\tpush\t20348851688\t4m46s\t2025-12-18T19:29:43Z\ncompleted\tfailure\tbd sync: 2025-12-18 12:29:38\tWindows Test\tmaster\tpush\t20348851674\t7m28s\t2025-12-18T19:29:43Z\ncompleted\tfailure\tbd sync: 2025-12-18 12:29:38\tbuild\tmaster\tpush\t20348851668\t5m32s\t2025-12-18T19:29:43Z\ncompleted\tfailure\tFix Windows builds by setting MRUBY_YAML_USE_SYSTEM_LIBRARY=1\tWindows Build\tmaster\tpush\t20347352897\t5m18s\t2025-12-18T18:37:33Z\ncompleted\tfailure\tFix Windows builds by setting MRUBY_YAML_USE_SYSTEM_LIBRARY=1\tWindows Test\tmaster\tpush\t20347352894\t5m17s\t2025-12-18T18:37:33Z\ncompleted\tfailure\tFix Windows builds by setting MRUBY_YAML_USE_SYSTEM_LIBRARY=1\tbuild\tmaster\tpush\t20347352893\t5m20s\t2025-12-18T18:37:33Z\ncompleted\tfailure\tFix Windows builds by setting MRUBY_YAML_USE_SYSTEM_LIBRARY=1\tWindows Package Manager Test\tmaster\tpush\t20347352889\t5m51s\t2025-12-18T18:37:33Z\ncompleted\tfailure\tUpdate actions/upload-artifact from v3 to v4\tWindows Test\tmaster\tpush\t20347192341\t3m12s\t2025-12-18T18:31:20Z\ncompleted\tfailure\tUpdate actions/upload-artifact from v3 to v4\tWindows Build\tmaster\tpush\t20347192328\t2m27s\t2025-12-18T18:31:20Z\ncompleted\tfailure\tUpdate actions/upload-artifact from v3 to v4\tbuild\tmaster\tpush\t20347192319\t5m28s\t2025-12-18T18:31:20Z\ncompleted\tfailure\tTemporarily comment out rubocop gems to fix Windows builds\tbuild\tmaster\tpush\t20347147440\t5m7s\t2025-12-18T18:29:37Z\nbuild\tactive\t148921388\nWindows Test\tactive\t148921586\nWindows Package Manager Test\tactive\t217123053\nWindows Build\tactive\t148921587","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-18T12:43:39.449098-07:00","updated_at":"2025-12-18T12:44:44.491171-07:00","closed_at":"2025-12-18T12:44:44.491171-07:00","close_reason":"Workflows are running but failing. Need to debug specific failures."}
{"id":"mitamae-cwb","title":"Add comprehensive Windows integration tests","description":"Add comprehensive Windows integration tests to verify mitamae functionality on Windows platforms. \n\nCONTEXT: GitHub workflows have been updated for fork compatibility (repository owner changed to dsisnero, token references fixed). Use 'gh' CLI to monitor workflow failures: 'gh run list', 'gh run view \u003cid\u003e --log', etc. (See AGENTS.md for details).\n\nWindows-specific workflow files:\n- windows.yml: Basic Windows build\n- test-windows.yml: Windows integration tests  \n- windows-package-test.yml: Package manager tests\n\nNeed to implement Windows-specific test recipes and verify they pass in CI. Should cover: file operations, package management (Chocolatey/WinGet), services, users/groups, and Windows path handling.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-18T10:49:34.025862-07:00","updated_at":"2025-12-18T12:42:51.233578-07:00","dependencies":[{"issue_id":"mitamae-cwb","depends_on_id":"mitamae-6cl","type":"blocks","created_at":"2025-12-18T12:45:53.873202-07:00","created_by":"daemon","metadata":"{}"}]}
{"id":"mitamae-dpp","title":"Fix Windows i386 host libyaml linkage (x86 triplet)","description":"Summary: Windows i386 build fails linking host mrbc with \"DllImportLibraryNotFound\" for -lyaml because the host build uses x64 vcpkg paths. Use the x86-windows triplet when the host build is configured for windows-i386 so the correct libyaml import library is found.\n\nFiles to modify:\n- build_config.rb\n\nImplementation steps:\n1. In the host MRuby::Build block, detect when windows-i386 is in BUILD_TARGET and set the vcpkg triplet to x86-windows.\n2. Ensure include/lib paths and linker library settings for yaml use that triplet.\n3. Keep the existing x64 triplet for other builds.\n\nExample:\n- Before: VCPKG triplet hardcoded to x64-windows.\n- After: triplet = build_targets.include?('windows-i386') ? 'x86-windows' : 'x64-windows'.\n","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-27T17:23:16.692879-07:00","created_by":"dominic","updated_at":"2025-12-27T17:23:57.068036-07:00","closed_at":"2025-12-27T17:23:57.068036-07:00","close_reason":"Set host vcpkg triplet based on windows-i386","dependencies":[{"issue_id":"mitamae-dpp","depends_on_id":"mitamae-6cl","type":"discovered-from","created_at":"2025-12-27T17:23:16.69376-07:00","created_by":"dominic"}]}
{"id":"mitamae-e13","title":"Add CONTRIBUTING.md guidelines","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T09:55:06.397927-07:00","updated_at":"2025-12-18T10:34:12.109389-07:00","closed_at":"2025-12-18T10:34:12.109389-07:00","close_reason":"Closed"}
{"id":"mitamae-f22","title":"Fix Windows CI junction cleanup failure","description":"Summary: Windows CI fails in Build mitamae due to Remove-Item failing on the junction path (D:\\m) being in use, causing the job to exit 1. Update workflows to ignore cleanup errors and reset location before removing the junction.\n\nFiles to modify:\n- .github/workflows/windows.yml\n- .github/workflows/test-windows.yml\n- .github/workflows/windows-package-test.yml\n\nImplementation steps:\n1. In each workflow Build mitamae step, add -ErrorAction SilentlyContinue to Remove-Item for the junction path.\n2. Ensure the script Set-Location back to the original directory before cleanup.\n3. Rerun Windows workflows to confirm cleanup no longer fails.\n\nExample:\n- Before: Remove-Item $shortPath -Force -Recurse\n- After: Set-Location $currentDir; Remove-Item $shortPath -Force -Recurse -ErrorAction SilentlyContinue","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-21T08:50:29.255966-07:00","updated_at":"2025-12-21T08:51:47.19072-07:00","closed_at":"2025-12-21T08:51:47.19072-07:00","close_reason":"Done"}
{"id":"mitamae-fc8","title":"Fix Windows command line length (Arg list too long) for mruby-specinfra compilation","description":"Windows build fails with 'Errno::E2BIG: Arg list too long' when mrbc tries to compile many mruby-specinfra mrblib files. Added patch to mruby command.rb to use response files when file count \u003e 100. Also added debug prints to log command length and response file creation.","status":"in_progress","priority":1,"issue_type":"bug","created_at":"2025-12-18T13:22:52.409763-07:00","updated_at":"2025-12-18T15:24:58.122968-07:00","dependencies":[{"issue_id":"mitamae-fc8","depends_on_id":"mitamae-6cl","type":"discovered-from","created_at":"2025-12-18T13:22:52.415442-07:00","created_by":"daemon","metadata":"{}"}]}
{"id":"mitamae-gra","title":"Use forked mruby-specinfra to avoid onig on Windows","description":"Summary: Switch mitamae to a forked mruby-specinfra that drops the mruby-onig-regexp dependency so Windows builds do not link oniguruma. Files to modify: mrbgem.rake. Implementation steps: 1) Fork itamae-kitchen/mruby-specinfra and remove the mruby-onig-regexp dependency from mrbgem.rake. 2) Update mrbgem.rake in this repo to use github: 'dsisnero/mruby-specinfra'. 3) Rerun Windows CI to confirm -lonig is gone. Example: spec.add_dependency 'mruby-specinfra', mgem: 'mruby-specinfra' -\u003e spec.add_dependency 'mruby-specinfra', github: 'dsisnero/mruby-specinfra'.","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-21T19:53:38.54308-07:00","updated_at":"2025-12-21T19:53:54.468926-07:00","dependencies":[{"issue_id":"mitamae-gra","depends_on_id":"mitamae-r9j","type":"discovered-from","created_at":"2025-12-21T19:53:38.54377-07:00","created_by":"dominic"}]}
{"id":"mitamae-hj8","title":"Fix Linux build: mruby directory not downloading","description":"Root cause: mruby directory existed but contained only 'lib' subdirectory (partial extraction). The :mruby task was skipped due to directory existence check. Fixed by checking for Rakefile presence and re-downloading if missing. Added debug prints to verify extraction.","status":"in_progress","priority":0,"issue_type":"bug","created_at":"2025-12-18T14:38:41.279158-07:00","updated_at":"2025-12-18T14:56:50.013845-07:00"}
{"id":"mitamae-hs9","title":"mrbc segfaults on empty response file","description":"Summary: mrbc crashes (exit 139) when invoked with an empty @response file instead of returning a user-facing error. This makes response-file handling unsafe for edge cases and breaks scripts that may generate empty rsp files.\\n\\nFiles to modify:\\n- mruby/mrbgems/mruby-bin-mrbc/tools/mrbc/mrbc.c (response file parsing / argv handling)\\n- test_response.rb (add regression case if we keep this script)\\n\\nImplementation steps:\\n1. Reproduce: create an empty response file and run mrbc with @file.\\n2. In mrbc.c, guard against zero arguments returned from response file parsing.\\n3. Emit a clear error (e.g., \"no input files\") and exit non-zero without crashing.\\n4. Add a regression test case (either in test_response.rb or new test) for empty response file.\\n\\nExample:\\n- Before: mrbc -Bempty -o /tmp/out.c @/tmp/empty.rsp -\u003e segfault (exit 139)\\n- After: mrbc -Bempty -o /tmp/out.c @/tmp/empty.rsp -\u003e prints error and exits with status != 0 (no crash)","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-27T14:44:01.498317-07:00","created_by":"dominic","updated_at":"2025-12-27T14:46:35.32819-07:00","closed_at":"2025-12-27T14:46:35.32819-07:00","close_reason":"Fixed: empty response file now errors cleanly; added regression test","dependencies":[{"issue_id":"mitamae-hs9","depends_on_id":"mitamae-8ll","type":"discovered-from","created_at":"2025-12-27T14:44:01.499229-07:00","created_by":"dominic"}]}
{"id":"mitamae-ib4","title":"Fix Windows build failure in mruby-etc (missing grp.h)","description":"Fix Windows build failure in mruby-etc (missing grp.h)\n\nSummary: Windows CI fails compiling mruby-etc because etc.c includes POSIX headers (grp.h/pwd.h/unistd.h/utsname.h) that do not exist on Windows. Implement Windows API-backed replacements and point mitamae at the forked mruby-etc repo that contains the fix.\n\nFiles to modify:\n- mruby-etc/src/etc.c (Windows implementations using GetUserNameW, token group lookup, GetComputerNameExW, etc.)\n- mruby-etc/mrbgem.rake (link advapi32 on Windows)\n- mrbgem.rake (use github: 'dsisnero/mruby-etc')\n\nImplementation steps:\n1. Replace Windows stubs with real API-backed helpers for Etc.getpwuid/getpwnam/getgrgid/getgrnam/getlogin/uname.\n2. Add advapi32 linker flags when building on Windows.\n3. Commit and push changes to dsisnero/mruby-etc.\n4. Point mitamae dependency to dsisnero/mruby-etc and push.\n5. Verify Windows CI compiles.\n\nExample:\n- Before: #include \u003cgrp.h\u003e fails on Windows\n- After: Windows build uses Win32 APIs and no POSIX headers","status":"in_progress","priority":1,"issue_type":"bug","created_at":"2025-12-21T08:09:32.158159-07:00","updated_at":"2025-12-21T08:28:06.716307-07:00"}
{"id":"mitamae-ii1","title":"Use forked mruby-shellwords to avoid onig on Windows","description":"Summary: Switch mitamae to a forked mruby-shellwords that drops the mruby-onig-regexp dependency so Windows i386 link does not require oniguruma. Files to modify: mrbgem.rake. Implementation steps: 1) Fork mrbgems/mruby-shellwords and remove the mruby-onig-regexp dependency from mrbgem.rake. 2) Update mrbgem.rake in this repo to use github: 'dsisnero/mruby-shellwords' instead of mgem. 3) Rerun Windows CI to confirm the onig link error is gone. Example: spec.add_dependency 'mruby-shellwords', mgem: 'mruby-shellwords' -\u003e spec.add_dependency 'mruby-shellwords', github: 'dsisnero/mruby-shellwords'.","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-21T19:28:35.944073-07:00","updated_at":"2025-12-21T19:29:04.795603-07:00"}
{"id":"mitamae-imt","title":"Fix Windows build failure in mruby-tempfile (S_ISVTX)","description":"Summary: Windows CI fails compiling mruby-tempfile because S_ISVTX is undefined. Add a Windows-compatible definition and ensure getpid uses _getpid on Windows. Update mitamae to use the forked mruby-tempfile.\n\nFiles to modify:\n- mruby-tempfile/src/tempfile.c (define S_ISVTX if missing, map getpid on Windows)\n- mrbgem.rake (use github: 'dsisnero/mruby-tempfile')\n\nImplementation steps:\n1. Add a fallback define for S_ISVTX when missing on Windows.\n2. Map getpid to _getpid under _WIN32.\n3. Push changes to dsisnero/mruby-tempfile and update mitamae dependency.\n4. Rerun Windows CI.\n\nExample:\n- Before: S_ISVTX undeclared\n- After: S_ISVTX defined as 0 on Windows","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-21T09:39:27.487125-07:00","updated_at":"2025-12-21T09:40:52.531606-07:00","closed_at":"2025-12-21T09:40:52.531606-07:00","close_reason":"Done"}
{"id":"mitamae-inw","title":"Capture Windows Test recipe failure output","description":"Summary: Windows Test \"Run comprehensive test recipe\" still fails with exit code 1 but no mitamae output shown in log. Capture and surface stderr/stdout to diagnose the underlying error.\n\nFiles to modify:\n- .github/workflows/test-windows.yml\n\nImplementation steps:\n1. Ensure the mitamae run captures stdout/stderr and prints the log content when the command fails.\n2. If output is still missing, add PowerShell to run with `-ErrorAction Continue` and explicitly output `$LASTEXITCODE` plus the log contents.\n3. Rerun CI to capture the error.\n\nExample:\n- Before: .\\mitamae-build\\mitamae-x86_64-windows.exe local -l debug windows_test.rb\n- After: Tee-Object output to windows_test.log and print it on failure.\n","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-12-27T17:23:23.937075-07:00","created_by":"dominic","updated_at":"2025-12-27T17:23:39.935031-07:00","dependencies":[{"issue_id":"mitamae-inw","depends_on_id":"mitamae-6cl","type":"discovered-from","created_at":"2025-12-27T17:23:23.937974-07:00","created_by":"dominic"}]}
{"id":"mitamae-jlo","title":"Fix Windows build failure in mruby-open3 (fork/exec)","description":"Summary: Windows CI fails compiling mruby-open3 because mrb_open3.c uses fork/exec and unistd.h. Implement a Windows CreateProcess-based spawn that respects stdout/stderr redirection and avoids POSIX headers. Update mitamae to use the forked mruby-open3.\n\nFiles to modify:\n- mruby-open3/src/mrb_open3.c (Windows CreateProcess implementation)\n- mrbgem.rake (use github: 'dsisnero/mruby-open3')\n\nImplementation steps:\n1. Add _WIN32 include guards and CreateProcess-based spawn with STARTUPINFO handles.\n2. Build a quoted command line from argv and honor chdir.\n3. Map Windows errors via _dosmaperr and raise mrb_sys_fail on failure.\n4. Push changes to dsisnero/mruby-open3 and update mitamae dependency.\n5. Rerun Windows CI.\n\nExample:\n- Before: fork()/execvp() not available on Windows\n- After: CreateProcess() used with inherited stdout/stderr handles","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-21T09:15:39.70964-07:00","updated_at":"2025-12-21T09:17:36.730777-07:00","closed_at":"2025-12-21T09:17:36.730777-07:00","close_reason":"Done"}
{"id":"mitamae-jnl","title":"Add CODE_OF_CONDUCT.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T09:55:08.508302-07:00","updated_at":"2025-12-18T10:34:13.623489-07:00","closed_at":"2025-12-18T10:34:13.623489-07:00","close_reason":"Closed"}
{"id":"mitamae-juv","title":"Verify Windows CI passes after response file patch","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-18T16:54:42.564507-07:00","updated_at":"2025-12-18T19:05:06.702963-07:00"}
{"id":"mitamae-le7","title":"Make Windows workflow caches persist across failing jobs","description":"Summary: Windows workflows report cache misses every run because cache save steps are skipped on job failure/cancellation. Enable cache saves even when jobs fail so Zig/Oniguruma/vcpkg artifacts persist once created.\n\nFiles to modify:\n- .github/workflows/windows.yml\n- .github/workflows/test-windows.yml\n- .github/workflows/windows-package-test.yml\n\nImplementation steps:\n1. Set actions/cache inputs to save on failure (e.g., save-always: true) for Zig, vcpkg, Ruby, and Oniguruma caches where appropriate.\n2. Consider adding restore-keys for vcpkg to reuse older caches when hash changes.\n3. Keep cache keys stable and scoped by target.\n\nExample:\n- Before: actions/cache@v4 without save-always\n- After: actions/cache@v4 with save-always: true (and optional restore-keys)\n","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T16:39:41.96497-07:00","created_by":"dominic","updated_at":"2025-12-27T17:02:07.792351-07:00","closed_at":"2025-12-27T17:02:07.792351-07:00","close_reason":"Remove Ruby cache; use restore/save with success guards","dependencies":[{"issue_id":"mitamae-le7","depends_on_id":"mitamae-6cl","type":"discovered-from","created_at":"2025-12-27T16:39:41.965779-07:00","created_by":"dominic"}]}
{"id":"mitamae-nf3","title":"Verify Windows CI passes with response file fix","description":"Original problem: Windows CI fails due to command line length limits when compiling 390+ mruby-specinfra files. After fixing linker error, need to verify Windows CI passes.\n\nWorkflows to check:\n- windows.yml (Windows build)\n- test-windows.yml (Windows integration tests)\n- windows-package-test.yml (Package manager tests)\n\nImplementation steps:\n1. After fixing linker error, push changes\n2. Monitor Windows CI runs\n3. Check for 'Arg list too long' errors are resolved\n4. Verify response files are being created in Windows builds (look for 'MRBC: Creating response file' debug output)\n5. Ensure Windows path handling works correctly (backslashes, drive letters)\n6. Test cross-compilation to Windows from Linux\n7. If issues persist, investigate Windows-specific command line limits or path handling\n\nSuccess criteria:\n- All Windows CI workflows pass (green)\n- No 'Arg list too long' errors\n- Response file debug output appears in logs\n- Cross-compilation produces working Windows binaries","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-19T14:23:26.631178-07:00","updated_at":"2025-12-19T23:50:15.389106-07:00","dependencies":[{"issue_id":"mitamae-nf3","depends_on_id":"mitamae-x1f","type":"discovered-from","created_at":"2025-12-19T14:23:26.632045-07:00","created_by":"daemon","metadata":"{}"}]}
{"id":"mitamae-nf3.1","title":"Fix mrbc.c compilation error: remove non-constant array initializer","description":"Fix compilation error in mrbc.c: force_include array used non-constant dummy_load_response_file variable.\n\nChanged Rakefile patch to remove the problematic array initializer while keeping dummy variable and constructor for linker inclusion.\n\nRoot cause: In C, static array initializers must be constant expressions. dummy_load_response_file is a variable (even though it's a function pointer), not a constant.\n\nFix: Remove the force_include array entirely, keep dummy_load_response_file variable with __attribute__((used)) and constructor that references load_response_file.\n\nExpected outcome: mrbc.c compiles without errors, linker includes load_response_file function, response file support works.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-19T15:02:14.576142-07:00","updated_at":"2025-12-19T17:54:15.334689-07:00","closed_at":"2025-12-19T17:54:15.334692-07:00","dependencies":[{"issue_id":"mitamae-nf3.1","depends_on_id":"mitamae-nf3","type":"parent-child","created_at":"2025-12-19T15:02:14.581367-07:00","created_by":"daemon","metadata":"{}"}]}
{"id":"mitamae-nf3.2","title":"Add comprehensive mrbc.c patching to ensure all components present","description":"Problem: mrbc.c linker error persists because patching logic only applied when response_argv fields were missing. When file already partially patched, critical components (function definition, dummy variable, cleanup handling) were skipped.\n\nSolution: Add comprehensive patching checks that ensure all required components exist regardless of partial patching state:\n\n1. Ensure load_response_file function definition exists (checks for #warning)\n2. Ensure dummy_load_response_file variable exists with __attribute__((used))\n3. Ensure constructor exists and fix volatile warning\n4. Ensure cleanup function handles response_argv memory\n5. Ensure load_file function detects @response files\n6. Ensure forward declaration has proper attributes\n\nAll checks run even when response_argv already present, ensuring complete patching.","notes":"Added top-level __asm__ volatile references at file scope to force function emission. Multiple redundant references ensure load_response_file symbol cannot be optimized away.","status":"in_progress","priority":1,"issue_type":"bug","created_at":"2025-12-19T17:54:27.369607-07:00","updated_at":"2025-12-20T10:39:08.753597-07:00","dependencies":[{"issue_id":"mitamae-nf3.2","depends_on_id":"mitamae-nf3","type":"parent-child","created_at":"2025-12-19T17:54:27.372738-07:00","created_by":"daemon","metadata":"{}"}]}
{"id":"mitamae-p37","title":"Add devbox/nix support for Windows development","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-18T10:49:49.520606-07:00","updated_at":"2025-12-18T10:49:49.520606-07:00","dependencies":[{"issue_id":"mitamae-p37","depends_on_id":"mitamae-6cl","type":"blocks","created_at":"2025-12-18T12:46:02.053081-07:00","created_by":"daemon","metadata":"{}"}]}
{"id":"mitamae-pqu","title":"Add pre-merge hook to update from upstream","description":"Added pre-merge-upstream hook script (scripts/pre-merge-upstream.sh) that fetches upstream and fast-forwards the main branch before merging. Hook is installed as .git/hooks/pre-merge-commit and can be skipped via SKIP_PRE_MERGE_UPSTREAM environment variable. Documentation added to CONTRIBUTING.md. The hook ensures the fork stays updated with upstream when merging into the main branch, preventing accidental merges with outdated upstream.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T10:38:41.505792-07:00","updated_at":"2025-12-18T12:29:26.996024-07:00","closed_at":"2025-12-18T12:29:26.996024-07:00","close_reason":"Implemented pre-merge-upstream hook script and documentation"}
{"id":"mitamae-r9j","title":"Use forked mruby-erb to avoid onig on Windows","description":"Summary: Switch mitamae to a forked mruby-erb that drops the mruby-onig-regexp dependency so Windows i386 linking no longer requires oniguruma. Files to modify: mrbgem.rake. Implementation steps: 1) Fork k0kubun/mruby-erb and remove the mruby-onig-regexp dependency from mrbgem.rake. 2) Update mrbgem.rake in this repo to use github: 'dsisnero/mruby-erb'. 3) Rerun Windows CI to confirm -lonig is no longer required. Example: spec.add_dependency 'mruby-erb', github: 'k0kubun/mruby-erb' -\u003e spec.add_dependency 'mruby-erb', github: 'dsisnero/mruby-erb'.","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-21T19:42:04.63023-07:00","updated_at":"2025-12-21T19:42:19.441778-07:00","dependencies":[{"issue_id":"mitamae-r9j","depends_on_id":"mitamae-ii1","type":"discovered-from","created_at":"2025-12-21T19:42:04.631114-07:00","created_by":"dominic"}]}
{"id":"mitamae-t7k","title":"Add Windows path handling compatibility","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T10:49:47.228821-07:00","updated_at":"2025-12-18T11:14:36.135041-07:00","closed_at":"2025-12-18T11:14:36.135043-07:00"}
{"id":"mitamae-vwx","title":"Windows build fails: libyaml headers missing for mruby-yaml","description":"Summary: Windows CI fails during mruby-yaml compilation because yaml.h is not found. This indicates libyaml headers are missing from the build environment.\\n\\nFiles to modify:\\n- .github/workflows/windows.yml (Install dependencies and PKG_CONFIG_PATH)\\n- .github/workflows/test-windows.yml (Install dependencies and PKG_CONFIG_PATH)\\n- .github/workflows/windows-package-test.yml (Install dependencies and PKG_CONFIG_PATH)\\n\\nImplementation steps:\\n1. Install libyaml via vcpkg for the target architecture (x64/x86).\\n2. Ensure PKG_CONFIG_PATH includes vcpkg's lib/pkgconfig so pkg-config finds libyaml.\\n3. Re-run Windows Build/Test/Package workflows to verify yaml.h is found.\\n\\nExample:\\n- Before: build/windows-x86_64/mrbgems/mruby-yaml/src/yaml.c -\u003e fatal error: 'yaml.h' file not found\\n- After: build succeeds past mruby-yaml compilation","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-27T15:57:56.979988-07:00","created_by":"dominic","updated_at":"2025-12-27T15:58:45.748712-07:00","closed_at":"2025-12-27T15:58:45.748712-07:00","close_reason":"Added libyaml vcpkg install and PKG_CONFIG_PATH update for Windows workflows","dependencies":[{"issue_id":"mitamae-vwx","depends_on_id":"mitamae-nf3","type":"discovered-from","created_at":"2025-12-27T15:57:56.981471-07:00","created_by":"dominic"}]}
{"id":"mitamae-we1","title":"Test mitamae compilation with mruby 3.4","description":"Current mruby version: 3.0.0 (from 2021). Need to test mitamae compilation with mruby 3.4 to:\n1. Determine if Windows command line length issue is resolved upstream\n2. Benefit from bug fixes and improvements in newer mruby versions\n3. Ensure long-term compatibility\n\nImplementation steps:\n1. Research mruby 3.4 changes and breaking changes\n2. Check if response file support (@response_file) already exists in mruby 3.4\n3. Update mruby dependency (submodule or vendored source)\n4. Test compilation on all platforms (Linux, macOS, Windows)\n5. Fix any incompatibilities in mitamae code\n6. Verify Windows CI passes without \"Arg list too long\" errors\n7. Run existing test suite to ensure no regressions\n\nFiles to modify:\n- mruby/ directory (replace with 3.4 source)\n- build_config.rb (adjust configuration if needed)\n- Rakefile (update patching logic if response file support already present)\n\nDependencies: This issue discovered while working on Windows command line length fix (mitamae-nf3). If mruby 3.4 already has response file support, our custom patches may become obsolete.\n\nSuccess criteria:\n- Mitamae compiles successfully with mruby 3.4\n- All existing tests pass\n- Windows CI passes without command line length errors\n- Response file functionality works (if still needed)","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-19T18:33:35.869268-07:00","updated_at":"2025-12-19T18:34:37.814861-07:00","dependencies":[{"issue_id":"mitamae-we1","depends_on_id":"mitamae-nf3","type":"discovered-from","created_at":"2025-12-19T18:35:05.013087-07:00","created_by":"daemon","metadata":"{}"}]}
{"id":"mitamae-wfp","title":"Fix Zig target for windows-i386 Oniguruma build","description":"Summary: Windows CI fails to build Oniguruma on windows-i386 because Zig 0.10.1 rejects the i686-windows-gnu target (UnknownArchitecture). Update workflow target mapping to use the correct Zig 32-bit target string.\\n\\nFiles to modify:\\n- .github/workflows/windows.yml (Build Oniguruma step target mapping)\\n- .github/workflows/test-windows.yml (Build Oniguruma step target mapping)\\n- .github/workflows/windows-package-test.yml (all Build Oniguruma steps target mapping)\\n\\nImplementation steps:\\n1. Replace the windows-i386 target mapping from i686-windows-gnu to i386-windows-gnu.\\n2. Ensure all Windows workflows use the updated mapping.\\n3. Push and verify Windows CI logs no longer show 'UnknownArchitecture' for i686 target.\\n\\nExample:\\n- Before: windows-i386 -\u003e i686-windows-gnu (zig error: UnknownArchitecture)\\n- After: windows-i386 -\u003e i386-windows-gnu (zig accepts target)","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-27T15:01:17.745222-07:00","created_by":"dominic","updated_at":"2025-12-27T15:02:12.947896-07:00","closed_at":"2025-12-27T15:02:12.947896-07:00","close_reason":"Updated windows-i386 Zig target to i386-windows-gnu in Windows workflow","dependencies":[{"issue_id":"mitamae-wfp","depends_on_id":"mitamae-6cl","type":"discovered-from","created_at":"2025-12-27T15:01:17.746078-07:00","created_by":"dominic"}]}
{"id":"mitamae-x1f","title":"Fix linker error: undefined reference to 'load_response_file' in mrbc","description":"CI builds fail with linker error: 'undefined reference to load_response_file' despite function being defined in mrbc.c with __attribute__((used)) and referenced by dummy variable.\n\nRoot cause: Function not being included in final binary despite attempts with __attribute__((used)), dummy variable reference, and (void)casts.\n\nFiles to modify:\n- Rakefile:lines 210-330 (mruby patching logic)\n- mruby/mrbgems/mruby-bin-mrbc/tools/mrbc/mrbc.c (patched file)\n\nImplementation steps:\n1. Examine object file symbols with nm/objdump to verify load_response_file is missing\n2. Try alternative approaches:\n   - Remove __attribute__((used)), ensure function is actually called\n   - Use #pragma GCC keep or similar compiler-specific directives\n   - Place function in separate compilation unit\n   - Use -Wl,--undefined=load_response_file linker flag\n   - Ensure function signature matches exactly\n3. Test locally with 'cd mruby \u0026\u0026 rake' to build host mrbc\n4. Verify mrbc binary contains load_response_file symbol\n5. Update Rakefile patching logic with working solution\n6. Push changes and verify CI passes\n\nExample fix approaches:\n- Force inclusion via linker script\n- Ensure function has external linkage (not static)\n- Add actual call to function in main() or initialization\n\nSTATUS: Fixed in commit 986fce4. Removed duplicate forward declaration, fixed asm syntax, ensured function definition is added. CI running to verify.","status":"in_progress","priority":1,"issue_type":"bug","created_at":"2025-12-19T14:22:22.528666-07:00","updated_at":"2025-12-20T11:55:22.27039-07:00"}
{"id":"mitamae-z3k","title":"Add pre-commit hooks for code quality","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T09:55:15.132269-07:00","updated_at":"2025-12-18T10:34:18.287542-07:00","closed_at":"2025-12-18T10:34:18.287542-07:00","close_reason":"Closed"}
